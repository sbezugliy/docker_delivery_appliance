---
services:
  frontend:
    image: frontend:staging
    env_file:
      - ../env/frontend/staging.env
    build:
      context: ../../apps/frontend/
      dockerfile: ../dockerfiles/frontend.Dockerfile
      target: production
    entrypoint: ["sbin", "frontend_prod"]
    networks:
      - stage
  backend:
    image: backend:staging
    env_file:
      - ../env/backend/staging.env
      - ../env/databases/postgres.env
      - ../env/databases/redis.env
    build:
      context: ../../apps/backend/
      dockerfile: ../dockerfiles/backend.Dockerfile
      target: production
    entrypoint: ["sbin", "backend_prod"]
    networks:
      - stage
